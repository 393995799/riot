!function(){function n(n,r,i){var a=r.__,l=[],s=[],d=[],b=[],C=[];this.root=n;p(n,function(n){var t=f(n),u=e(n);var o=_(u.if);if(o){C.push(new m(n,r,i,function(){return o.apply(r,i)}));return false}if(t=="yield"){l.push(n);return false}var p=_(u.each);if(p){s.push([p,n]);return false}var v=u.name||u.id;if(v&&v[0]!="$")a.addRef(v,n);if(n!=r.root&&c(n)){var h=new g(t,n,k(n,u),r);a.addChild(t,h);d.push(h);return false}var y=_(n.nodeValue);if(y){w(n,y)}B(n,u)});s=s.map(function(n){return y(n[0],n[1],r,i)});t(l,function(n){o(r.parent.root.firstChild.nextSibling,n,function(n){r.parent.__.addBlock(n)});u(n)});this.update=function(){t(C.concat(d).concat(s),function(n){n.update()});t(b,function(n){n.apply(r,i)})};function _(n){if(n){n=n.trim();var t=1*n.slice(1);if(n[0]=="$"&&t>=0)return a.fns[t]}}function w(n,t){b.push(function(){var e=t.apply(r,i),u=h(e);if(v(e)){var a=n.parent||n.parentNode;a.innerHTML=u;n.parent=a}else n.nodeValue=u})}function A(n,t,e){n.removeAttribute(t);n.addEventListener(t.slice(2),function(n){var t=i.concat([n]),u=e.apply(r,t);if(u){var a=u.apply(r,t);r.update();return a}})}function k(n,t){var e={},u=[];for(var a in t){var o=t[a];var f=_(o);e[a]=f?f.apply(r,i):o;f&&n.removeAttribute(a)}return e}function B(n,t){Object.keys(t).forEach(function(e){var u=_(t[e]);if(!u)return;n.setAttribute(e,"");if(e.slice(0,2)=="on"){A(n,e,u)}else{b.push(function(){var t=u.apply(r,i),a=n.changed||n;t===false?a.removeAttribute(e):a.setAttribute(e,h(t))})}})}}function t(n,t){if(n){for(var e=0;e<n.length;e++){if(t(n[e],e)===false)e--}}}function e(n){var e={};t(n.attributes,function(n){e[n.name]=n.value});return e}function r(){return document.createTextNode("")}function i(n,t){n.parentNode.insertBefore(t,n);return t}function u(n){var t=n.parentNode;t&&t.removeChild(n)}function a(n,t){while(n.firstChild)t.appendChild(n.firstChild)}function o(n,t,e){while(n.firstChild){var r=n.firstChild;i(t,r);e(r)}}function f(n){var t=n.tagName;return t&&t.toLowerCase()}function c(n){var t=f(n);return t&&!!_[t.toLowerCase()]}function l(n,e){t(Object.keys(e),function(t){n[t]=e[t]});return n}function s(n){var t=document.createElement("template");t.innerHTML=n.trim();return(t.content||t).firstChild}function p(n,t){if(t(n)===false)return;n=n.firstChild;while(n){if(p(n,t)===false)return;n=n.nextSibling}}function d(n){var t=[];for(var e in n){var r=n[e];if(r)t.push(e=="_html"?r:e)}return t.join(" ")}function v(n){for(var t=0,e;e=(n||[])[t];t++){if(e._html)return true}}function h(n){return Array.isArray(n)?n.map(h).join(""):n==null?"":typeof n=="object"?d(n):n}function m(n,t,e,a){n.removeAttribute("if");var o=i(n,r()),f=t.__;this.update=function(){return a()?l():c()};function c(){f.removeBlock(n);u(n)}function l(){i(o,n);f.addBlock(n,e)}}function y(n,e,a,o){e.removeAttribute("each");o=o||[];var f=e.previousSibling,c=[],l={},s;if(!f){f=r();e.parentNode.appendChild(f)}var p=i(f,r());u(e);l.update=function(){var e=n.apply(a,o);if(s==e)return;if(Array.isArray(e)){if(s)s.splice(0,s.length);t(e,h);s=y(e)}else if(e&&!s){b(e);s=e}};function d(n,t,e){a.__.addBlock(n,o.concat([t,e]))}function v(n,t){var r=e.cloneNode(true);i(t,r);return r}function h(n,t){var e=v(n,f);c.push(e);d(e,n,t)}function m(n,t){var e=v(n,p.nextSibling);c.unshift(e);d(e,n,t)}function y(n){var e=n.push;n.push=function(t){e.call(n,t);h(t);a.update()};var r=n.unshift;n.unshift=function(t){r.call(n,t);m(t);a.update()};var i=n.splice;n.splice=function(e,r){t(c.slice(e,e+r),function(n){a.__.removeBlock(n);u(n)});c.splice(e,r);i.call(n,e,r)};n.remove=function(t){var e=n.indexOf(t);if(e>=0)return n.splice(e,1)};var o=n.sort;n.sort=function(e){t(c,u);c=[];o.call(n,e);t(n,h);a.update()};return n}function b(n){Object.keys(n).forEach(function(t){var e=n[t];h(t,e)})}l.update();return l}var b=window.riot={},C=[],_={};b.tag=function(n,t,e,r){_[n]=[t,e,r]};b.mount=function(n,t,e){var r=new g(n,t,e);C.push(r);return r.update()};b.update=function(){t(C,function(n){n.update()})};function g(e,r,i,u){var o=_[e];if(!o)throw"No such tag "+e;var c=this.root=s(o[0]),p=this.tags={},d=this.refs={},v=this,h=[];function m(n,t){Object.defineProperty(v,n,{get:function(){return t},set:function(t){throw"Cannot set "+n}});return t}m("opts",i);m("parent",u);m("update",function(n){if(n)l(v,n);t(h,function(n){n.update()});return v});var y=m("__",{fns:o[1],addBlock:function(t,e){var r=new n(t,v,e);h.push(r);return r},removeBlock:function(n){t(h,function(t,e){if(t.root==n)h.splice(e,1)})},addChild:function(n,t,e){e=e||p;var r=e[n];if(Array.isArray(r))r.push(t);else e[n]=r?[r,t]:t},addRef:function(n,t){y.addChild(n,t,d)}});y.addBlock(c,[]);var b=o[2];b&&b.call(v,v,i);if(r){if(f(r)==e){a(c,r);c.changed=r;c=r}else{r.parentNode.replaceChild(c,r)}}}}();